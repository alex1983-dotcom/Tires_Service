# README.md для проекта

## Описание приложения user_registration

Данное приложение представляет собой веб-приложение для управления 
пользователями и сервисами, связанными с хранением и обслуживанием шин. 
Приложение реализовано на Django и использует Django REST Framework для 
создания API. Основные функции включают регистрацию пользователей, 
управление записями на обслуживание автомобиля, а также систему скидок.

## Структура проекта

Проект состоит из следующих основных компонентов:

- **models.py**: Определяет модели данных, используемые в приложении.
- **views.py**: Содержит представления для обработки HTTP-запросов.
- **admin.py**: Настройки административной панели для управления моделями.
- **forms.py**: Определяет формы для регистрации пользователей и сброса пароля.

## Модели (models.py)

### 1. User
Модель пользователя с кастомизированной аутентификацией. Включает следующие поля:
- `first_name`: Имя пользователя.
- `last_name`: Фамилия пользователя.
- `middle_name`: Отчество (опционально).
- `email`: Электронная почта (уникальная).
- `username`: Имя пользователя (уникальное).
- `phone_number`: Номер телефона (уникальный).
- `is_active`: Статус активности пользователя.
- `is_staff`: Статус администратора.
- `last_login`: Дата и время последнего входа.

#### Методы:
- `get_full_name()`: Возвращает полное имя пользователя.
- `get_short_name()`: Возвращает сокращенное имя пользователя.

### 2. Discount
Модель для хранения информации о скидках, связанных с пользователями.
- `user`: Внешний ключ на модель User.
- `total_spent`: Общая сумма, потраченная пользователем.
- `discount_rate`: Процент скидки.

#### Методы:
- `calculate_discount()`: Рассчитывает сумму скидки.
- `update_total_spent(amount)`: Обновляет общую потраченную сумму.

### 3. TireStorage
Модель для хранения информации о шинах.
- `user`: Внешний ключ на модель User.
- `entry_date`: Дата поступления шин.
- `exit_date`: Дата выхода шин.
- `daily_rate`: Суточная ставка хранения.
- `tire_model`: Модель шины.
- `tire_size`: Размер шины.
- `quantity`: Количество шин.

#### Методы:
- `calculate_storage_cost()`: Рассчитывает стоимость хранения шин.

### 4. ServiceAppointment
Модель для записи клиентов на обслуживание.
- `user`: Внешний ключ на модель User.
- `car_model`: Модель автомобиля.
- `service_date`: Дата обслуживания.
- `service_time`: Время обслуживания.
- `additional_info`: Дополнительная информация.

### 5. PasswordResetCode
Модель для хранения кода сброса пароля.
- `phone_number`: Номер телефона пользователя.
- `code`: Код сброса пароля.
- `expiry_date`: Срок действия кода.

#### Методы:
- `is_valid()`: Проверяет, действителен ли код сброса пароля.

## Представления (views.py)

### 1. AdminLoginView
Представление для входа администратора. Обрабатывает GET и POST запросы 
для отображения и обработки формы входа.

### 2. RegisterView
Представление для регистрации пользователя. Обрабатывает GET и POST 
запросы для отображения и обработки формы регистрации.

### 3. LoginView
Представление для входа пользователя в систему. Обрабатывает GET и POST 
запросы для отображения и обработки формы входа.

### 4. PasswordResetRequestView
Представление для запроса сброса пароля. Обрабатывает GET и POST запросы 

для отображения и обработки формы запроса сброса пароля.

### 5. PasswordResetConfirmView
Представление для подтверждения кода и ввода нового пароля. Обрабатывает 
GET и POST запросы для отображения и обработки формы сброса пароля.

### 6. PersonalCabinetView
Представление для отображения личного кабинета пользователя. Загружает 
информацию о скидках, записях на обслуживание и хранении шин.

### 7. API представления
- **ServiceAppointmentListView**: Получает список всех записей на 
    обслуживание и создает новую запись.
- **ServiceAppointmentDetailView**: Получает информацию о конкретной записи на обслуживание и удаляет её.
- **UserListView**: Получает список всех пользователей.
- **UserDetailView**: Получает информацию о конкретном пользователе и 
    удаляет его.

## Административная панель (admin.py)

### 1. UserAdmin
Настройки для управления моделью User в административной панели. Включает 
поля для отображения, фильтрации и поиска.

### 2. DiscountAdmin
Настройки для управления моделью Discount в административной панели.

### 3. TireStorageAdmin
Настройки для управления моделью TireStorage в административной панели.

### 4. ServiceAppointmentAdmin
Настройки для управления моделью ServiceAppointment в административной 
панели.

## Формы (forms.py)

### 1. PasswordResetRequestForm
Форма для запроса сброса пароля по номеру телефона.

### 2. PasswordResetConfirmForm
Форма для подтверждения сброса пароля с кодом и новым паролем.

### 3. UserRegistrationForm
Форма регистрации пользователя. Использует UserCreationForm и добавляет 
дополнительные поля.

### 4. AdminEmailAuthenticationForm
Форма аутентификации администратора по email.

## Установка и запуск

1. Клонировать репозиторий:
   ```bash
   git clone <url>
   ```

2. Установить зависимости:
   ```bash
   pip install -r requirements.txt
   ```

3. Настроить переменные окружения в файле `.env`.

4. Выполнить миграции базы данных:
   ```bash
   python manage.py migrate
   ```

5. Запустите сервер разработки:
   ```bash
   python manage.py runserver
   ```

Теперь вы можете получить доступ к приложению по адресу 
`http://127.0.0.1:8000/`.

## Заключение

Данный проект демонстрирует использование Django и Django REST Framework 
для создания полноценного веб-приложения с системой управления 
пользователями и сервисами. Вы можете расширять функционал, добавляя новые 
модели и представления, а также улучшать интерфейс и пользовательский опыт.